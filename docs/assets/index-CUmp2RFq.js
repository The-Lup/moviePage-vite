(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const s="da70fb845a8b3dc87d9a2b5b2089b552",l="https://api.themoviedb.org/3";async function d(e){try{const a=await fetch(e);if(!a.ok)throw new Error("Error en la API");return await a.json()}catch(a){return console.error(a),{results:[]}}}async function p(e="movie",a=1){return d(`${l}/${e}/popular?api_key=${s}&language=es-ES&page=${a}`)}async function f(e="movie"){return d(`${l}/genre/${e}/list?api_key=${s}&language=es-ES`)}async function E({type:e,page:a,genreId:r,yearMin:i,yearMax:n}){let o=`${l}/discover/${e}?api_key=${s}&language=es-ES&page=${a}&sort_by=popularity.desc`;return r&&(o+=`&with_genres=${r}`),i&&(o+=`&primary_release_date.gte=${i}-01-01`),n&&(o+=`&primary_release_date.lte=${n}-12-31`),d(o)}async function h(e,a="movie",r=1){return d(`${l}/search/${a}?api_key=${s}&language=es-ES&query=${encodeURIComponent(e)}&page=${r}`)}async function I(e,a="movie"){return d(`${l}/${a}/${e}?api_key=${s}&language=es-ES`)}function B(e,a="movie"){var r,i;return`
    <div class="movie-card" data-id="${e.id}" data-type="${a}">
      <img src="https://image.tmdb.org/t/p/w500${e.poster_path}" alt="${e.title||e.name}">
      <h3>${e.title||e.name}</h3>
      <p>${((r=e.release_date)==null?void 0:r.slice(0,4))||((i=e.first_air_date)==null?void 0:i.slice(0,4))||"Sin fecha"}</p>
    </div>
  `}function u(e,a="movie",r="movie-container"){const i=document.getElementById(r);i.innerHTML="";const n=document.createDocumentFragment();e.forEach(o=>{const c=document.createElement("div");c.innerHTML=B(o,a),n.appendChild(c.firstElementChild)}),i.appendChild(n)}function v(e,a="genre-filter"){const r=document.getElementById(a);r.innerHTML='<option value="">Todos los géneros</option>',e.forEach(i=>{const n=document.createElement("option");n.value=i.id,n.textContent=i.name,r.appendChild(n)})}const t={type:"movie",genreId:null,page:1,yearMin:null,yearMax:null,query:null};async function _(){const e=document.getElementById("genre-filter"),a=document.getElementById("year-min"),r=document.getElementById("year-max"),i=document.getElementById("apply-filters"),n=await f(t.type);v(n.genres),i.addEventListener("click",async()=>{t.genreId=e.value||null,t.yearMin=a.value||null,t.yearMax=r.value||null,t.page=1;const o=await E(t);u(o.results,t.type),document.getElementById("page-number").textContent=t.page})}function b(){const e=document.getElementById("prev-page"),a=document.getElementById("next-page"),r=document.getElementById("page-number");async function i(){let n;t.query?n=await h(t.query,t.type,t.page):t.genreId||t.yearMin||t.yearMax?n=await E(t):n=await p(t.type,t.page),u(n.results,t.type),r.textContent=t.page}e.addEventListener("click",()=>{t.page>1&&(t.page--,i())}),a.addEventListener("click",()=>{t.page++,i()})}function w(e,a=500){let r;return(...i)=>{clearTimeout(r),r=setTimeout(()=>e(...i),a)}}function L(){const e=document.getElementById("search-input");e.addEventListener("input",w(async()=>{const a=e.value.trim();if(t.query=a||null,t.page=1,!t.query)return;const r=await h(t.query,t.type,t.page);u(r.results,t.type),document.getElementById("page-number").textContent=t.page},500))}function M(){const e=document.getElementById("type-select");e.value=t.type,e.addEventListener("change",async()=>{t.type=e.value,t.page=1,t.query=null,t.genreId=null,t.yearMin=null,t.yearMax=null;const a=await f(t.type);v(a.genres);const r=await p(t.type,t.page);u(r.results,t.type),document.getElementById("page-number").textContent=t.page})}function S(){const e=document.getElementById("movie-modal"),a=document.getElementById("modal-body"),r=document.getElementById("close-modal");async function i(n,o){var y,m,g;const c=await I(n,o);a.innerHTML=`
      <img src="https://image.tmdb.org/t/p/w500${c.poster_path}" alt="${c.title||c.name}">
      <h2>${c.title||c.name}</h2>
      <p><strong>Género:</strong> ${((y=c.genres)==null?void 0:y.map($=>$.name).join(", "))||"N/A"}</p>
      <p><strong>Año:</strong> ${((m=c.release_date)==null?void 0:m.slice(0,4))||((g=c.first_air_date)==null?void 0:g.slice(0,4))||"N/A"}</p>
      <p>${c.overview||"Sin descripción disponible."}</p>
    `,e.style.display="flex"}r.addEventListener("click",()=>e.style.display="none"),e.addEventListener("click",n=>{n.target===e&&(e.style.display="none")}),document.getElementById("movie-container").addEventListener("click",n=>{const o=n.target.closest(".movie-card");o&&i(o.dataset.id,o.dataset.type)})}async function x(){const e=await p(t.type,t.page);u(e.results,t.type),M(),_(),b(),L(),S()}x();
